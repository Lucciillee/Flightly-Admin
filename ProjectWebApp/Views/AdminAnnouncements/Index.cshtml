@model ProjectWebApp.ViewModels.AnnouncementVM

@{
    Layout = "~/Views/Shared/_LayoutAdmin.cshtml";
    ViewData["Title"] = "Send Announcements";
}

@section Styles {
    <link rel="stylesheet" href="~/css/admin-announcements.css" asp-append-version="true" />
}

<!-- Floating Stat (Top Right Under Header) -->
<div class="top-bar">
    <div class="notif-stat">
        <span class="label">Total Announcements Sent:</span>
        <span class="count">@Model.TotalAnnouncements</span>
    </div>
</div>

<div class="content">

    <!-- Success / Error Messages -->
    @if (TempData["Success"] != null)
    {
        <div class="alert success">@TempData["Success"]</div>
    }
    @if (TempData["Error"] != null)
    {
        <div class="alert error">@TempData["Error"]</div>
    }

    <!-- Main Content -->
    <section class="grid2">

        <!-- Create Notification -->
        <div class="card">
            <div class="card-h">Create Announcements</div>
            <div class="card-b">
                <form class="grid1" method="post" asp-action="Send">

                    <label class="field">
                        <span>Title</span>
                        <input type="text" asp-for="Title" placeholder="New Feature Announcement" />
                    </label>

                    <label class="field">
                        <span>Message</span>
                        <textarea rows="4" asp-for="Message" placeholder="Write your Announcement here..."></textarea>
                    </label>

                    <div class="actions">
                        <button type="reset" class="btn">Reset</button>
                        <button type="submit" class="btn primary">Send Announcement</button>
                    </div>
                </form>
            </div>
        </div>

        <!-- Recent Notifications -->
        <div class="card">
            <div class="card-h">Recent Announcements</div>
            <div class="card-b scroll">
                <table class="table">
                    <thead>
                        <tr>
                            <th>Title</th>
                            <th>Message</th>
                            <th>Sent On</th>
                        </tr>
                    </thead>
                    <tbody>
                        @if (Model.RecentAnnouncements != null && Model.RecentAnnouncements.Any())
                        {
                            foreach (var item in Model.RecentAnnouncements)
                            {
                                <tr>
                                    <td>@item.Title</td>
                                    <td>@item.Message</td>
                                    <td>@item.CreatedAt.ToString("yyyy-MM-dd")</td>
                                </tr>
                            }
                        }
                        else
                        {
                            <tr>
                                <td colspan="3" style="text-align:center; padding:20px; color:#888;">
                                    No announcements found.
                                </td>
                            </tr>
                        }
                    </tbody>
                </table>
            </div>
        </div>

    </section>
</div>
