@{
    Layout = "~/Views/Shared/_LayoutAdmin.cshtml";
    ViewData["Title"] = "Dashboard Overview";
}

@section Styles {
    <link rel="stylesheet" href="~/css/Admin-dashboard.css" asp-append-version="true" />
}

<section class="content dashboard">

    <!-- Row 1: Stats -->
    <div class="row tiles">
        <div class="card stat blue">
            <div class="icon">🧾</div>
            <div class="text">
                <div class="label">Total Bookings</div>
                <div class="value">12,438</div>
            </div>
        </div>

        <div class="card stat purple">
            <div class="icon">✈️</div>
            <div class="text">
                <div class="label">Active Flights</div>
                <div class="value">324</div>
            </div>
        </div>

        <div class="card stat green">
            <div class="icon">💰</div>
            <div class="text">
                <div class="label">Revenue (MTD)</div>
                <div class="value">$842k</div>
            </div>
        </div>

        <div class="card stat orange">
            <div class="icon">👥</div>
            <div class="text">
                <div class="label">Registered Users</div>
                <div class="value">58,120</div>
            </div>
        </div>
    </div>

    <!-- Row 2 -->
    <div class="row row-2col">
        <div class="card">
            <div class="card-h">Recent Bookings</div>
            <div class="card-b">
                <table class="table">
                    <thead>
                        <tr><th>Ref</th><th>User</th><th>Flight</th><th>Status</th><th>Total</th></tr>
                    </thead>
                    <tbody>
                        <tr><td>#BK-10421</td><td>Rana A.</td><td>BAH→DXB (GF 008)</td><td><span class="badge ok">Confirmed</span></td><td>$420</td></tr>
                        <tr><td>#BK-10420</td><td>Guest</td><td>BAH→DOH (QR 271)</td><td><span class="badge warn">Pending</span></td><td>$365</td></tr>
                        <tr><td>#BK-10419</td><td>Ali M.</td><td>BAH→RUH (SV 112)</td><td><span class="badge bad">Cancelled</span></td><td>$0</td></tr>
                    </tbody>
                </table>
            </div>
        </div>

        <div class="card center">
            <div class="card-h">Booking Status</div>
            <div class="card-b">
                <canvas id="flightChart"></canvas>
            </div>
        </div>
    </div>


    <!-- Row 3 -->
    <div class="row row-3col">
        <div class="card chart">
            <div class="card-h">Revenue Trend</div>
            <div class="card-b"><canvas id="revenueChart"></canvas></div>
        </div>

        <div class="card chart">
            <div class="card-h">User Growth</div>
            <div class="card-b"><canvas id="userChart"></canvas></div>
        </div>

        <div class="card chart">
            <div class="card-h">Top Routes</div>
            <div class="card-b"><canvas id="routesChart"></canvas></div>
        </div>
    </div>

    <!-- Row 4 -->
    <div class="row row-full">
        <div class="card">
            <div class="card-h">Top Performing Airlines</div>
            <div class="card-b">
                <table class="table">
                    <thead><tr><th>Airline</th><th>Flights This Month</th><th>Average Load (%)</th><th>Revenue</th><th>Trend</th></tr></thead>
                    <tbody>
                        <tr><td>Gulf Air</td><td>142</td><td>91%</td><td>$1.2M</td><td><span class="badge ok">+8%</span></td></tr>
                        <tr><td>Qatar Airways</td><td>128</td><td>88%</td><td>$1.05M</td><td><span class="badge ok">+5%</span></td></tr>
                        <tr><td>Emirates</td><td>116</td><td>86%</td><td>$990K</td><td><span class="badge warn">+2%</span></td></tr>
                        <tr><td>Saudia</td><td>104</td><td>79%</td><td>$850K</td><td><span class="badge bad">-3%</span></td></tr>
                    </tbody>
                </table>
            </div>
        </div>
    </div>

</section>

<!-- Chart.js CDN -->
<script src="https://cdn.jsdelivr.net/npm/chart.js"></script>

<script>
    const baseOpts = {
        responsive: true,
        maintainAspectRatio: false,
        plugins: { legend: { display: false } },
        scales: { x: { grid: { display: false } }, y: { grid: { color: '#f3f4f6' } } }
    };

    // Line Chart - Revenue
    new Chart(document.getElementById('revenueChart'), {
        type: 'line',
        data: {
            labels: ['Jan', 'Feb', 'Mar', 'Apr', 'May', 'Jun'],
            datasets: [{
                label: 'Revenue ($K)',
                data: [420, 560, 720, 690, 800, 940],
                borderColor: '#2563eb',
                backgroundColor: 'rgba(37,99,235,0.1)',
                fill: true,
                tension: 0.4
            }]
        },
        options: baseOpts
    });

    // Bar Chart - Users
    new Chart(document.getElementById('userChart'), {
        type: 'bar',
        data: {
            labels: ['Jan', 'Feb', 'Mar', 'Apr', 'May', 'Jun'],
            datasets: [{
                label: 'Users',
                data: [1200, 1500, 1800, 2500, 3000, 3500],
                backgroundColor: '#7c3aed',
                borderRadius: 6
            }]
        },
        options: baseOpts
    });

    // Doughnut - Top Routes
    new Chart(document.getElementById('routesChart'), {
        type: 'doughnut',
        data: {
            labels: ['BAH→DXB', 'BAH→DOH', 'BAH→RUH'],
            datasets: [{
                data: [45, 30, 25],
                backgroundColor: ['#2563eb', '#7c3aed', '#f97316'],
                borderWidth: 0
            }]
        },
            options: {
        maintainAspectRatio: false,
        responsive: true,
        cutout: '70%',
        radius: '90%',
        layout: {
            padding: { bottom: 10 }
        },
        plugins: {
            legend: {
                position: 'bottom',
                align: 'center',
                labels: {
                    boxWidth: 14,
                    padding: 6,
                    font: { size: 12 }
                }
            }
        }
    }

    });

      // Booking Status - Donut
new Chart(document.getElementById('flightChart'), {
    type: 'doughnut',
    data: {
        labels: ['Confirmed', 'Pending', 'Cancelled'],
        datasets: [{
            data: [65, 25, 10],
            backgroundColor: ['#10b981', '#facc15', '#ef4444'],
            borderWidth: 0
        }]
    },
    options: {
        maintainAspectRatio: false,
        responsive: true,
        cutout: '70%',
        layout: {
            padding: { bottom: 25 } // ⬅️ adds space below the donut
        },
        plugins: {
            legend: {
                position: 'bottom',
                align: 'center',
                labels: {
                    boxWidth: 14,
                    padding: 16, // ⬅️ adds more space between donut & labels
                    font: { size: 12 }
                }
            }
        }
    }
});


</script>
